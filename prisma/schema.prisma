// Prisma schema for PostgreSQL migration from MongoDB
// Datasource and generator

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x", "rhel-openssl-3.0.x"]
}

// Enums
enum Priority {
  low
  medium
  high
}

// Models
model User {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  password  String
  todos     Todo[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Todo {
  id        String    @id @default(cuid())
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String
  title     String
  description String? @default("")
  dueDate   DateTime?
  completed Boolean   @default(false)
  priority  Priority  @default(medium)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([userId, createdAt(sort: Desc)])
  @@index([completed])
  @@index([priority])
}
